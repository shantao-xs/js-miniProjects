<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Type Ahead ğŸ‘€</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="https://fav.farm/ğŸ”¥" />
</head>
<body>

  <form class="search-form">
    <input type="text" class="search" placeholder="City or State">
    <ul class="suggestions">
      <li>Filter for a city</li>
      <li>or a state</li>
    </ul>
  </form>

  <!--æ€ä¹ˆä»ä¸€ä¸ª.jsonæ–‡ä»¶ç½‘ç«™ä¸­è·å–å…·ä½“çš„jsonæ–‡ä»¶ä¸­çš„dataé›†åˆï¼Ÿ
  ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥è·å–ï¼Ÿ
  åŸºäºprototypeåŸå‹çš„Javascriptï¼šæ²¡æœ‰ç»§æ‰¿æ–¹æ³•ï¼Œæ‰€ä»¥JavaScriptè¦å¼•ç”¨åˆ«çš„æ–¹æ³•éœ€è¦åµŒå¥—ä¸€å±‚å±‚çš„åŸå‹ï¼Œç›´åˆ°å¼•ç”¨åˆ°é‚£ä¸ªæœ‰æ–¹æ³•çš„objectï¼Œæ¯”å¦‚è¦è·å–.jsonæ–¹æ³•ï¼Œå°±éœ€è¦æ‰¾åˆ°responseè¿™ä¸ªproto
  æ€ä¹ˆæŠŠè·å–çš„dataé›†åˆå­˜å…¥ä¸€ä¸ªarrayï¼Ÿé’ˆå¯¹constç±»å‹çš„å¸¸æ•°ï¼Œä½¿ç”¨.push(...data)çš„æ–¹æ³•æ¥ä¸æ–­å¢åŠ æ–°æ•°

  æ³¨ï¼šåœ¨consoleä¸­å†™å…¥å˜é‡å¦‚citiesï¼Œç­‰æ•ˆäºconsole.log(cities)ï¼ŒåŒæ ·å¯ä»¥èµ·åˆ°æ£€æŸ¥çš„æ•ˆæœ
  -->
  <!--
1.è¯»å–æ•°æ®
2.ç›‘å¬é”®ç›˜è¾“å…¥çš„å­—æ¯
3.æ ¹æ®ç›‘å¬ç»“æœï¼ˆè¿™é‡Œéœ€è¦ç”¨åˆ°regexæ­£åˆ™ï¼Œå…¨å±€æŸ¥æ‰¾å¹¶å¿½ç•¥å¤§å°å†™ï¼‰ï¼Œã€æŸ¥æ‰¾ã€‘æ•°æ®ä¸­æ˜¯å¦å­˜åœ¨æœ‰â€œxxâ€œå­—æ ·çš„ç»“æœï¼Œå¦‚æœ‰åˆ™è¿”å›æœ‰çš„ç»“æœarrayï¼ˆcountry&stateéƒ½è¦)
4.æ ¹æ®è¿”å›çš„ç»“æœé›†åˆè¿›è¡Œã€å±•ç¤ºã€‘ï¼Œè®¾ç½®htmlçš„æ ¼å¼ï¼šéå†æ•°ç»„ï¼Œä¸€ä¸€å±•ç¤ºä¸º<li>ï¼Œå¹¶å¥—å…¥class=suggestionçš„æ ·å¼é‡Œï¼ˆç”¨.innerHTML()è·å–htmlå†…å®¹ï¼‰
    !!!æ³¨æ„ï¼šè¿™é‡Œéœ€è¦å…ˆéå†ï¼Œå†joinï¼Œè®©å®ƒæˆä¸ºä¸€ç»„æ•°æ®è€Œä¸æ˜¯ä¸€æ¡ï¼

addEventListenerè¿”å›çš„æ˜¯äº‹ä»¶objï¼Œè€Œä¸æ˜¯å…·ä½“çš„arrayå€¼ï¼Œè¦ä»eventä¸­æå–å€¼

find()åªæ˜¾ç¤ºæ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªç­”æ¡ˆ
filter()æ˜¾ç¤ºæ‰¾åˆ°çš„æ‰€æœ‰ç­”æ¡ˆ

æ­£åˆ™ï¼šéœ€è¦ç”¨new regExp(word,'gi')æ¥ç”Ÿæˆ
åº”ç”¨æ­£åˆ™ï¼šstring.prototype.match(æ­£åˆ™) OR æ­£åˆ™.test(string.prototype)

ç›‘å¬ï¼šç›‘å¬ä¸éœ€è¦èµ‹å€¼ç»™å˜é‡ï¼Œç›‘å¬æ–¹æ³•æœ¬èº«ä¼šè¿”å›undefinedè€Œä¸æ˜¯ç›‘å¬åˆ°çš„äº‹ä»¶å¯¹è±¡ï¼Œç›‘å¬è¦é€šè¿‡event.target.valueæ¥è®¿é—®ç›‘å¬åˆ°çš„äº‹ä»¶å¯¹è±¡çš„å€¼
event.xxx å’Œç›‘å¬äº‹ä»¶æœ‰å…³çš„ä¸€äº›å€¼

è¯¯åŒºï¼
å‚æ•°ä¼ é€’è¿˜æ˜¯å…¨å±€å˜é‡ï¼Ÿ
å¦‚æœè¦åœ¨å‡½æ•°findKeyWordé‡Œä½¿ç”¨citiesæ•°ç»„ï¼Œ
æ³•1ï¼šå®šä¹‰citiesä¸ºå…¨å±€å˜é‡ç›´æ¥å¼•ç”¨
æ³•2ï¼šåœ¨å‡½æ•°é‡Œè®¾ç½®å‚æ•°citiesï¼Œå¹¶ä¸”åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„.addEventListener('keyup',findKeyWord)é‡ŒæŠŠfindKeyWordè¿™é‡Œä¼ å…¥citiesæ•°ç»„
ä¸ç„¶ä¼šå¯¼è‡´cities uncaught

å…·ä½“æ€ä¹ˆå†™ï¼Ÿå¦‚æœè¦ä¸­é€”testçš„ï¼Œè¦åœ¨consoleé‡Œè¾“å…¥æ–¹æ³•æ¥testï¼Œè¿™ç§æœ€å¥½æŠŠå‚æ•°è®¾è®¡å¥½

todo å…¶ä»–å¾…åŠï¼š1.ç»™å…³é”®è¯åŠ highlight:ç”¨.replace()æŠŠæ­£åˆ™æ¢æˆåˆ«çš„æ ·å¼`<span>${...}</span>`
todo 2.ç»“æœç”¨ä¼˜å…ˆçº§æ’åºï¼šå…ˆå±•ç¤ºcityåŒ¹é…ï¼Œå†å±•ç¤ºstateåŒ¹é…
  -->

<script>
const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';

const cities = [];
fetch(endpoint)
  .then(blob => blob.json())
  .then(data=>cities.push(...data));

function findKeyWord(inputwords,cities){
  const regex = new RegExp(inputwords,'gi');
  const targetCities = cities.filter(each=>{
    return each.city.match(regex)||each.state.match(regex);
  });
  return targetCities;
}


function displayFind(){
  const result = findKeyWord(this.value,cities);
  const html =  result.map(each=>{
    const regex = new RegExp(this.value,'gi');
    const cityHL = each.city.replace(regex,`<span class="hl">${this.value}</span>`);
    const stateHL = each.state.replace(regex,`<span class="hl">${this.value}</span>`);
    return  `
      <li>
        <span class="name">${cityHL}, ${stateHL}</span>  
        <span class="name">${each.population}</span>
      </li>
    `;
  }).join('');
  suggestions.innerHTML=html;
}

const suggestions = document.querySelector('.suggestions');
const searches = document.querySelector('.search');
searches.addEventListener('keyup',displayFind);

</script>
</body>
</html>
